<!DOCTYPE html>
<html>

<head>
    <title><%= title %></title>
    <%- include("./common/stylesheets.ejs", {isAdmin: false}) %>
</head>

<body>
    <%- include("./common/header.ejs", {adminMenu: false, backMenu: true, backAdmin: false, backToMonth: false, id: null}) %>
    <div class="msg">
        <div class="msgarea">
            <p class="msgarea__text">『まかない』は食べましたか？</p>
            <button class="msgarea__okbtn">はい</button>
            <button class="msgarea__ngbtn">いいえ</button>
        </div>
    </div>
    <div class="container-action">
        <form method="POST" name="timeform" action="/time/set">
            <div class="action-area">
                <div class="wow fadeIn" class="start-area">
                    <% if (user.time_start) { %>
                        <p id="startbtn" class="start nonactive"><%= user.time_start.slice(0,2) + ':' + user.time_start.slice(2,4) %></p>
                    <% } else { %>
                        <p id="startbtn" class="start">出勤</p>
                    <% } %>
                </div>
                <div class="wow fadeIn" class="end-area">
                    <% if (user.time_start) { %>
                        <% if (user.time_end) { %>
                            <p id="endbtn" class="end nonactive"><%= user.time_end.slice(0,2) + ':' + user.time_end.slice(2,4) %></p>
                        <% } else { %>
                            <p id="endbtn" class="end">退勤</p>
                        <% } %>
                    <% } else { %>
                        <p id="endbtn" class="end nonactive">退勤</p>
                    <% } %>
                </div>
                <input type="hidden" name="yyyymmdd" value="<%= yyyymmdd %>" id="yyyymmdd">
                <input type="hidden" name="time_start" value="<%= user.time_start %>">
                <input type="hidden" name="time_end" value="<%= user.time_end %>">
                <input type="hidden" name="shorikubun" value="" id="shorikubun">
                <input type="hidden" name="id" value="<%= user.id %>">
                <input type="hidden" name="kubun" id="kubun" value="<%= user.kubun %>">
                <input type="hidden" name="makanai" id="makanai" value="">
            </div>
        </form>
        <script>

            let okbtn = document.getElementsByClassName("msgarea__okbtn")[0];
            okbtn.addEventListener('click', () => {
                document.getElementById("makanai").value = "1";
                document.timeform.action = "/time/set";
                document.timeform.submit();
            });

            let ngbtn = document.getElementsByClassName("msgarea__ngbtn")[0];
            ngbtn.addEventListener('click', () => {
                document.getElementById("makanai").value = "0";
                document.timeform.action = "/time/set";
                document.timeform.submit();
            });

            let startbtn = document.getElementById("startbtn");
            let endbtn = document.getElementById("endbtn");
            startbtn.addEventListener('click', () => {
                document.getElementById("shorikubun").value = "start";
                document.timeform.submit();
            });
            endbtn.addEventListener('click', () => {
                document.getElementById("shorikubun").value = "end";
                if (document.getElementById("kubun").value === '2') {
                    scrollTo(0, 0);
                    let msg = document.getElementsByClassName("msg")[0];
                    msg.style.visibility = "visible";
                } else {
                    document.timeform.action = "/time/set";
                    document.timeform.submit();
                }
            });
            // if (startbtn.innerHTML !== '出勤') {
            //     startbtn.classList.add("nonactive");
            // };
            // if ((startbtn.innerHTML === '出勤') || (endbtn.innerHTML !== '退勤')) {
            //     endbtn.classList.add("nonactive");
            // };
        </script>
</body>
<%- include("./common/javascripts.ejs") %>

</html>